buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
        maven {url 'https://jenkins.cs.ox.ac.uk/artifactory/plugins-snapshot'}
        maven {url 'https://jenkins.cs.ox.ac.uk/artifactory/plugins-release'}

    }
    dependencies {
        classpath "uk.ac.ox.softeng.maurodatamapper.gradle:mdm-gradle-plugin:$mdmGradlePluginVersion"
    }
}

plugins {
    id 'groovy'
    id 'com.github.johnrengelman.shadow' version '8.1.1'
    id 'io.micronaut.application' version '4.3.1'
    id 'io.micronaut.aot' version '4.3.1'
    //    id('io.micronaut.test-resources') version '4.3.1'
}

apply plugin: 'uk.ac.ox.softeng.maurodatamapper.gradle.mauro-gradle'
apply plugin: 'info.solidsoft.pitest'

application {
    mainClass.set("uk.ac.ox.softeng.mauro.controller.Application")
}

graalvmNative{
    toolchainDetection = false
}

micronaut {
    runtime("netty")
    testRuntime("spock2")
    processing {
        incremental(true)
        annotations("uk.ac.ox.softeng.mauro.*")
    }
    aot {
        // Please review carefully the optimizations enabled below
        // Check https://micronaut-projects.github.io/micronaut-aot/latest/guide/ for more details
        optimizeServiceLoading = false
        convertYamlToJava = false
        precomputeOperations = true
        cacheEnvironment = true
        optimizeClassLoading = true
        deduceEnvironment = true
        optimizeNetty = true
    }
}

apply from: 'dependencies.gradle'